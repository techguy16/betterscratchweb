// These will be replaced at build-time by generate-service-worker-plugin.js
const HTML_ASSETS = ["editor.html","index.html","fullscreen.html","addons.html"];
const LAZY_ASSETS = ["static/assets/bf550f4c2ff75abf5d2d76e87470af92.svg","static/assets/589eaf6a247df5343b584fd0fa848489.svg","static/assets/cee477fa706ab6fe733a65edd475c41b.svg","static/assets/3e6a0a68ee1872bee1f93e4428bcb993.svg","static/assets/344dc88f4d5187f0d86f2f13c9ef1727.mp3","static/assets/e75c65e1679e0cc2800caa5c47823daa.mp3","static/assets/fefb7e2fcd4d311a5a7c3de5a8ae5b64.mp3","static/assets/a42b5a072afdc2d1aa55accfb1168fb3.mp3","static/assets/26a4aecd5158e8663b90d5edfba5e25a.mp3","static/assets/352dc6cd98d372680a5297f6ffc50ec4.mp3","static/assets/fcb21f71cf289f827e01b18b7c3fdc85.mp3","static/assets/367d7189e8dac8a0ca2828830a91db83.mp3","static/assets/dd8f636a1df01f3d3768998081387ea4.mp3","static/assets/311ef566eba52b1729fd02d8944b4378.mp3","static/assets/1bff35b71e6f52017b123be4f9904d54.mp3","static/assets/b74faacb619dad0b5f3871a04a6bcd0e.mp3","static/assets/c40ccf288c211a9441bb714db775d334.mp3","static/assets/2291f2138819385c9a5750130f254f90.mp3","static/assets/484c379b1da007ecb5f66780a119fa2e.mp3","static/assets/1c9099a7cf1c142492de1603b20b0d44.mp3","static/assets/7231a404390e5fe96856a5ec5182745c.mp3","static/assets/06fd0604a4bf62a2b706edc23e49a086.mp3","static/assets/52ac58d8ef4e53d6449e592b68359d46.mp3","static/assets/af0caec5f8ac3a35c9769e1e07918e14.mp3","static/assets/579529cc3c40887f6ecc771c4b39809d.mp3","static/assets/048d12d9e01a42ab48fb6ce57100f6f8.mp3","static/assets/41ebcde49032d543af1a2c843a725834.mp3","static/assets/c5b3d36982acf8f9acc53c3964100460.mp3","static/assets/3299cad6fda8c0a3d957a5ea75060677.mp3","static/assets/bf99fbafe9a01e45da63a6874cd8f4b2.mp3","static/assets/2bae7059d4f81f344b02cc34567e548d.mp3","static/assets/d4708e8517c8e85b5c1948c845e662ba.mp3","static/assets/4734f3fe917e80ae53b9f1f4e3d62147.mp3","static/assets/96d18383c71ad5ceff1152859b46c508.mp3","static/assets/b5f8889e91e6d51fc294dfd1125c1240.mp3","static/assets/8589d7e6689f31ec2c251be25ac95c1b.mp3","static/assets/2ec048ddd7a7e30b94f8d24c22892112.mp3","static/assets/527756fb4ee6a19086a69e0ea8355b5c.mp3","static/assets/f151dc9a8eb14b4d9c64795e1cbae7e0.mp3","static/assets/3d55b957c09e11fe0d75f4f2a84bdf53.mp3","static/assets/e3af35844a01f8f64d2bea326db21a35.mp3","static/assets/52d442dc8e71307ec251603d1edd35f0.mp3","static/assets/5610fba29744cce750f1da6c6091ecac.mp3","static/assets/19161c89a6ca04006606ca3f4f91fdec.mp3","static/assets/2352f743e6b883d53e0b09b84ddea79b.mp3","static/assets/9d76e4ccf26072c4bddaa81a765ab08a.mp3","static/assets/25c294b62fe9e614db125a4f65cc6044.mp3","static/assets/a386a58fa9c00de141c32b5b11e5327e.mp3","static/assets/c20d558f1fc823a96de910456827d90c.mp3","static/assets/912e19a8fe314f46ab3df3fed9578a29.mp3","static/assets/2613dd347943b2ed7c6edb22e0cf7e0a.mp3","static/assets/6d912e9240790715a077d422cdbc19a5.mp3","static/assets/b2b4ad5307e24c6627f2077478017981.mp3","static/assets/ecea3eba4a9e187eb6cc7cc6a6b4bb4d.mp3","static/assets/a16ff5830a119789f5bc5d29a42ace64.mp3","static/assets/7cf82cd9bd601cfee5e715c0eb5343ef.mp3","static/assets/bd1e18eb36346861c5c57be8ed2ba5e3.mp3","static/assets/23d5956ad3641d4663a17353c71477b0.mp3","static/assets/f44e9579ce45c384ed76054ee5e98270.mp3","static/assets/32e0021542e34f09a747322d11868f23.mp3","static/assets/1c8b575f37b1a519fc3cdc5183bb85c0.mp3","static/assets/a9eccab64d64a3114344d56af142741e.mp3","static/assets/1ac03a53ecc806b652579f9f8da7c58a.mp3","static/assets/7d2d28d80d4ae06acb4fdbde429448e6.svg","static/assets/a11919e102077f40302da55fb9150440.svg","static/assets/78e3f697df85275aa8d384ca6fc0e288.svg","static/assets/00aa0c4320b93631ab3c223604ead431.svg","static/assets/f6d9f33ec366a89a58b3cf0e125adf97.svg","static/assets/165746cd277a144ddefd62ac5d67b696.svg","static/assets/af8e46c9477a8cadeb6c26b4686407a5.svg","static/assets/f9a0fb45ee35279e05b6f4e637509777.svg","static/assets/3a296d85c85a5f222663dad932737c86.svg","static/assets/65715c37a18debd4b44a80c478a3abd7.svg","static/assets/1900166faa9222d0d10c568a12c848a5.png","static/assets/7c410b6c3cd2a9ee41505c5c6951bbf6.png","static/assets/7ad5cc6ed3d0a5fd6a273078fe3999f0.svg","static/assets/223d68e7b8769bac1f33291514ce5bac.svg","static/assets/cd200d8b59d5c3d4ff3a69a774f5fac3.svg","static/assets/48df3abff5e8eb9a597f355daaf5348c.png","static/assets/bc0fbf502b38884f440135ddae40016d.svg","static/assets/d259fcbecaa9d2a22d19848daff9d4c6.svg","static/assets/79a644579518611a7b397f85a32cfb85.svg","static/assets/d1f6af6170e0178514f35fedc62e5eab.svg","static/assets/2501d1b87cf04e00cc3a623fa8b5d95c.svg","static/assets/e91530fe8f85b7fdc983b48ab3b9885d.svg","static/assets/c14c0c1e852949eff4e6c069772b0015.svg","static/assets/32d903cafc72328bd30afce14bfa4c79.svg","static/assets/7efe82fffae735cd083388badd51b3fa.svg","static/assets/674db5c2e49df884273ac0f7d221865c.svg","static/assets/566d73a090e3d42d5bdfee3d92c79d25.svg","static/assets/82072226e8cf716289165650c31eeda2.svg","static/assets/7808d3b49fdf33cb82e053f00a27ba33.png","static/assets/7c67e2601425784a243cd7e0f15c50a3.svg","static/assets/b3a6f3783f393f641dc3e51211dd50f4.svg","static/assets/945297ca77c041c98377f204e1af772e.svg","static/assets/306ffbcffad0d931fb1d158dd812f3fe.svg","static/assets/98bfc66ce081a3750f3b59ab67d0ac75.svg","static/assets/90fb0caa5319c39b24946476dd32bb0d.svg","static/assets/489ff1ee9cc0de0d38330e82c65c543c.svg","static/assets/3c06b74c80d1e6b1d210ca86c87cd326.svg","static/assets/e4dfc45f34b4606356c4c70ba14a96f0.svg","static/assets/64e66a9dcf4b42a699f49e5973a4a62e.svg","static/assets/a72a652fdc84dc6983d3cc9596c36a26.svg","static/assets/ed3fe9e11706e76990709ac2e567ada6.svg","static/assets/85f62e9e77bed58778782e6cce58c1f4.svg","static/assets/b1f026ce265c0f666e2063ef94b06109.svg","static/assets/679ce05ac8c35bbf83f596e895ab711b.svg","static/assets/61e99f0da6828d62aa9e3761c15ace9f.svg","static/assets/93babda8f98fc8009c28e97f1f118b6f.png","static/assets/c216c70ef78cc80a1538a3accc6612af.svg","static/assets/7bd83c9ad44bff4a20f0c19726adf8be.svg","static/assets/c3a88fa1746d8e5169db188302979317.svg","static/assets/8505df165b778979791da5caaee96fea.png","static/assets/cf07199bb768b01e6ac2a5c68fd8c3bb.svg","static/assets/89833a109ba5105c76ee1fb007d6811b.svg","static/assets/e6e16daaf665399c8826497dfb888260.svg","static/assets/40167d33efb7d0929a3bcbc591fc78b0.svg","static/assets/76024aad6524bdf0e8d438f4d024e581.png","static/assets/5b36d8cf15d803226e2fe4c0737be43f.svg","static/assets/adc0b35e696de431abb9dd3ea90a5deb.svg","static/assets/c73619fea5bb43c53a080399a35273be.png","static/assets/64e4a905e7c3ab32ef03272631c3df75.png","static/assets/d1f14e4e1372d8f9c0908d2f45aa5b54.svg","static/assets/7d043362c1c4cabd22aeb93b43fc5fc6.svg","static/assets/db18366b02c46fdf9033c9a4a13f911b.png","static/assets/9c604018c786598c0f198af5e798cd16.png","static/assets/8969372a821bd2a0170ed9a68a3e238d.png","static/assets/37954fe300d44f8765b6d48b2836fcf5.png","static/assets/ff69eb6d9e2044232f0187954982fb3c.png","static/assets/c6ab79fc9e76cb500fc83b6f1c6437d0.png","static/assets/296357261fb7d74c06765aadb0ff1026.svg","static/assets/6e51f9cfc9bfca2f4fb88d1fe1ec2615.png","static/assets/9c0ac6e5681567da6d6f6004ba107658.svg","static/assets/831a9fd5f488f356a5031c289e4c35fe.svg","static/assets/86f568a0ecc0badac2c4952b39fff148.svg","static/assets/9d5be1463602fd5ac397d01e8a436eb2.png","static/assets/1157205071ed65c811dbb73fb4a01305.ttf","static/assets/1e9845b965f84b5719b7232a81fefc84.ttf","static/assets/1e42fb0552204ffda375eaf9779df330.ttf","static/assets/0fbf0f28b13c0f6395c23facb7c7bb34.ttf","static/assets/bc97443df1d87914d75725d53a1e8eae.ttf","static/assets/df1cdbb7886c4a3faed089d2a4661935.otf","static/assets/ccb0bda27bef3666a5b4e209b2e95fe8.ttf","js/addon-default-entry.js","js/addon-entry-2d-color-picker.js","js/addon-entry-better-img-uploads.js","js/addon-entry-block-count.js","js/addon-entry-block-palette-icons.js","js/addon-entry-blocks2image.js","js/addon-entry-cat-blocks.js","js/addon-entry-clones.js","js/addon-entry-columns.js","js/addon-entry-copy-reporter.js","js/addon-entry-custom-block-shape.js","js/addon-entry-custom-block-text.js","js/addon-entry-custom-zoom.js","js/addon-entry-data-category-tweaks-v2.js","js/addon-entry-debugger.js","js/addon-entry-default-costume-editor-color.js","js/addon-entry-disable-paste-offset.js","js/addon-entry-disable-stage-drag-select.js","js/addon-entry-editor-buttons-reverse-order.js","js/addon-entry-editor-colored-context-menus.js","js/addon-entry-editor-compact.js","js/addon-entry-editor-extra-keys.js","js/addon-entry-editor-number-arrow-keys.js","js/addon-entry-editor-sounds.js","js/addon-entry-editor-square-inputs.js","js/addon-entry-editor-stage-left.js","js/addon-entry-editor-stepping.js","js/addon-entry-editor-theme3.js","js/addon-entry-fullscreen.js","js/addon-entry-gamepad.js","js/addon-entry-hide-delete-button.js","js/addon-entry-hide-flyout.js","js/addon-entry-hide-new-variables.js","js/addon-entry-hide-stage.js","js/addon-entry-initialise-sprite-position.js","js/addon-entry-load-extensions.js","js/addon-entry-mediarecorder.js","js/addon-entry-mouse-pos.js","js/addon-entry-move-to-top-layer.js","js/addon-entry-no-script-bumping.js","js/addon-entry-number-pad.js","js/addon-entry-paint-by-default.js","js/addon-entry-paint-snap.js","js/addon-entry-remove-curved-stage-border.js","js/addon-entry-remove-sprite-confirm.js","js/addon-entry-script-snap.js","js/addon-entry-search-sprites.js","js/addon-entry-sprite-properties.js","js/addon-entry-swap-local-global.js","js/addon-entry-transparent-orphans.js","js/addon-entry-tw-disable-cloud-variables.js","js/addon-entry-tw-disable-compiler.js","js/addon-entry-tw-remove-backpack.js","js/addon-entry-tw-remove-feedback.js","js/addon-entry-tw-straighten-comments.js","js/addon-entry-variable-manager.js","js/addon-entry-vol-slider.js","js/addon-entry-zebra-striping.js","js/addon-l10n-de.js","js/addon-l10n-es.js","js/addon-l10n-fi.js","js/addon-l10n-fr.js","js/addon-l10n-hu.js","js/addon-l10n-it.js","js/addon-l10n-ja.js","js/addon-l10n-ko.js","js/addon-l10n-nl.js","js/addon-l10n-pl.js","js/addon-l10n-pt.js","js/addon-l10n-ro.js","js/addon-l10n-ru.js","js/addon-l10n-sl.js","js/addon-l10n-tr.js","js/addon-l10n-zh-tw.js","js/addon-settings.js","js/addons.js","js/editor.js","js/fullscreen.js","js/player.js","js/sb.js","js/vendors~addon-settings~addons~editor~fullscreen~player.js","js/vendors~addon-settings~credits~editor~embed~fullscreen~player.js","js/vendors~editor~embed~fullscreen~player.js","js/vendors~editor~fullscreen~player.js","static/blocks-media/default/click.mp3","static/blocks-media/default/click.ogg","static/blocks-media/default/click.wav","static/blocks-media/default/comment-arrow-down.svg","static/blocks-media/default/comment-arrow-up.svg","static/blocks-media/default/delete-x.svg","static/blocks-media/default/delete.mp3","static/blocks-media/default/delete.ogg","static/blocks-media/default/delete.wav","static/blocks-media/default/dropdown-arrow-dark.svg","static/blocks-media/default/dropdown-arrow.svg","static/blocks-media/default/eyedropper.svg","static/blocks-media/default/green-flag.svg","static/blocks-media/default/handclosed.cur","static/blocks-media/default/handdelete.cur","static/blocks-media/default/handopen.cur","static/blocks-media/default/repeat.svg","static/blocks-media/default/rotate-left.svg","static/blocks-media/default/rotate-right.svg","static/blocks-media/default/sprites.png","static/blocks-media/default/status-not-ready.svg","static/blocks-media/default/status-ready.svg","static/blocks-media/default/zoom-in.svg","static/blocks-media/default/zoom-out.svg","static/blocks-media/default/zoom-reset.svg","static/blocks-media/default/extensions/music-block-icon.svg","static/blocks-media/default/extensions/pen-block-icon.svg","static/blocks-media/default/icons/arrow.svg","static/blocks-media/default/icons/arrow_button.svg","static/blocks-media/default/icons/control_forever.svg","static/blocks-media/default/icons/control_repeat.svg","static/blocks-media/default/icons/control_stop.svg","static/blocks-media/default/icons/control_wait.svg","static/blocks-media/default/icons/remove.svg","static/blocks-media/high-contrast/click.mp3","static/blocks-media/high-contrast/click.ogg","static/blocks-media/high-contrast/click.wav","static/blocks-media/high-contrast/comment-arrow-down.svg","static/blocks-media/high-contrast/comment-arrow-up.svg","static/blocks-media/high-contrast/delete-x.svg","static/blocks-media/high-contrast/delete.mp3","static/blocks-media/high-contrast/delete.ogg","static/blocks-media/high-contrast/delete.wav","static/blocks-media/high-contrast/dropdown-arrow-dark.svg","static/blocks-media/high-contrast/dropdown-arrow.svg","static/blocks-media/high-contrast/eyedropper.svg","static/blocks-media/high-contrast/green-flag.svg","static/blocks-media/high-contrast/handclosed.cur","static/blocks-media/high-contrast/handdelete.cur","static/blocks-media/high-contrast/handopen.cur","static/blocks-media/high-contrast/repeat.svg","static/blocks-media/high-contrast/rotate-left.svg","static/blocks-media/high-contrast/rotate-right.svg","static/blocks-media/high-contrast/sprites.png","static/blocks-media/high-contrast/status-not-ready.svg","static/blocks-media/high-contrast/status-ready.svg","static/blocks-media/high-contrast/zoom-in.svg","static/blocks-media/high-contrast/zoom-out.svg","static/blocks-media/high-contrast/zoom-reset.svg","static/blocks-media/high-contrast/extensions/music-block-icon.svg","static/blocks-media/high-contrast/extensions/pen-block-icon.svg","static/blocks-media/high-contrast/icons/arrow.svg","static/blocks-media/high-contrast/icons/arrow_button.svg","static/blocks-media/high-contrast/icons/control_forever.svg","static/blocks-media/high-contrast/icons/control_repeat.svg","static/blocks-media/high-contrast/icons/control_stop.svg","static/blocks-media/high-contrast/icons/control_wait.svg","static/blocks-media/high-contrast/icons/remove.svg"];
const LAZY_ASSETS_NAME = "tw-lazy-bf21a9e8fbc5a3846fb05b4fa0859e0917b2202f";

const knownCaches = [
    LAZY_ASSETS_NAME
];
const base = location.pathname.substr(0, location.pathname.indexOf('sw.js'));

self.addEventListener('install', event => {
    self.skipWaiting();
    event.waitUntil(caches.open(LAZY_ASSETS_NAME).then(cache => cache.addAll(HTML_ASSETS)));
});

self.addEventListener('activate', event => {
    event.waitUntil(
        caches.keys().then(keys => Promise.all(keys.filter(i => !knownCaches.includes(i)).map(i => caches.delete(i))))
    );
});

self.addEventListener('fetch', event => {
    const url = new URL(event.request.url);
    if (url.origin !== location.origin) return;
    if (event.request.method !== 'GET') return;

    let relativePathname = url.pathname.substr(base.length);
    if (/^(\d+\/?)?$/.test(relativePathname)) {
        relativePathname = 'index.html';
    } else if (/^(\d+\/)?editor\/?$/i.test(relativePathname)) {
        relativePathname = 'editor.html';
    } else if (/^(\d+\/)?fullscreen\/?$/i.test(relativePathname)) {
        relativePathname = 'fullscreen.html';
    } else if (/^addons\/?$/i.test(relativePathname)) {
        relativePathname = 'addons.html';
    }

    if (HTML_ASSETS.includes(relativePathname)) {
        event.respondWith(
            fetch(event.request).catch(() => caches.match(new Request(relativePathname)))
        );
    } else if (LAZY_ASSETS.includes(relativePathname)) {
        event.respondWith(
            caches.open(LAZY_ASSETS_NAME).then(cache => cache.match(new Request(relativePathname)).then(response => (
                response || fetch(event.request).then(networkResponse => {
                    cache.put(event.request, networkResponse.clone());
                    return networkResponse;
                })
            )))
        );
    }
});
